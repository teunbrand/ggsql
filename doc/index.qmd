---
title: "ggsql - SQL Visualization Grammar"
---

A SQL extension for declarative data visualization based on the Grammar of Graphics.

ggsql allows you to write queries that combine SQL data retrieval with visualization specifications in a single, composable syntax.

## Example

```ggsql
SELECT date, revenue, region
FROM sales
WHERE year = 2024
VISUALISE date AS x, revenue AS y, region AS color
DRAW line
LABEL title => 'Sales by Region'
THEME minimal
```

## Project Status

âœ¨ **Active Development** - Core functionality is working with ongoing feature additions and refinements.

**Completed:**

- âœ… Complete tree-sitter grammar with SQL + VISUALISE parsing
- âœ… Full AST type system with validation
- âœ… DuckDB reader with comprehensive type handling
- âœ… Vega-Lite writer with multi-layer support
- âœ… CLI tool (`ggsql`) with parse, exec, and validate commands
- âœ… REST API server (`ggsql-rest`) with CORS support
- âœ… Jupyter kernel (`ggsql-jupyter`) with inline Vega-Lite visualizations
- âœ… knitr-engine (`ggsql-jupyter`) with inline Vega-Lite visualizations
- âœ… VS Code extension (`ggsql-vscode`) with syntax highlighting for `.ggsql` files

**Planned:**

- ðŸ“‹ Additional readers
- ðŸ“‹ Additional writers
- ðŸ“‹ More geom types and statistical transformations
- ðŸ“‹ Enhanced theme system

## Architecture

ggsql splits queries at the `VISUALISE` boundary:

- **SQL portion** â†’ passed to pluggable readers (DuckDB, PostgreSQL, CSV, etc.)
- **VISUALISE portion** â†’ parsed and compiled into visualization specifications
- **Output** â†’ rendered via pluggable writers (ggplot2, PNG, Vega-Lite, etc.)

## Grammar Specification

See [CLAUDE.md](CLAUDE.md) for the in-progress ggsql grammar specification, including:

- Syntax reference
- AST structure
- Implementation phases and architecture
- Design principles and philosophy

Key grammar elements:

- `VISUALISE [mappings] [FROM source]` - Entry point with global aesthetic mappings
- `DRAW <geom> [MAPPING] [SETTING] [FILTER]` - Define geometric layers (point, line, bar, etc.)
- `SCALE <aesthetic> SETTING` - Configure data-to-visual mappings
- `FACET` - Create small multiples (WRAP for flowing layout, BY for grid)
- `COORD` - Coordinate transformations (cartesian, flip, polar)
- `LABEL`, `THEME`, `GUIDE` - Styling and annotation

## Jupyter Kernel

The `ggsql-jupyter` package provides a Jupyter kernel for interactive ggsql queries with inline Vega-Lite visualizations.

### Installation

```bash
cargo build --release --package ggsql-jupyter
./target/release/ggsql-jupyter --install
```

### Usage

After installation, create a new notebook with the "ggsql" kernel or use `%kernel ggsql` in an existing notebook.

```sql
-- Create data
CREATE TABLE sales AS
SELECT * FROM (VALUES
    ('2024-01-01'::DATE, 100, 'North'),
    ('2024-01-02'::DATE, 120, 'South')
) AS t(date, revenue, region)

-- Visualize with ggsql using global mapping
SELECT * FROM sales
VISUALISE date AS x, revenue AS y, region AS color
DRAW line
SCALE x SETTING type => 'date'
LABEL title => 'Sales Trends'
```

The kernel maintains a persistent DuckDB session across cells, so you can create tables in one cell and query them in another.

### Quarto

A Quarto example can be found in `ggsql-jupyter/tests/quarto/doc.qmd`.

## VS Code Extension

The `ggsql-vscode` extension provides syntax highlighting for ggsql files in Visual Studio Code.

### Installation

```bash
# Package the extension
cd ggsql-vscode
npm install -g @vscode/vsce
vsce package

# Install the VSIX file
code --install-extension ggsql-0.1.0.vsix
```

### Features

- **Syntax highlighting** for ggsql keywords, geoms, aesthetics, and SQL
- **File association** for `.ggsql`, `.ggsql.sql`, and `.gsql` extensions
- **Bracket matching** and auto-closing for parentheses and brackets
- **Comment support** for `--` single-line and `/* */` multi-line comments

The extension uses a TextMate grammar that highlights:

- SQL keywords (SELECT, FROM, WHERE, JOIN, etc.)
- ggsql clauses (VISUALISE, DRAW, SCALE, COORD, FACET, etc.)
- Geometric objects (point, line, bar, area, etc.)
- Aesthetics (x, y, color, size, shape, etc.)
- Scale types (linear, log10, date, viridis, etc.)

## CLI

### Installation

```bash
cargo install --path src
```
