[package]
name = "ggsql"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
homepage.workspace = true
description.workspace = true

[lib]
name = "ggsql"
path = "lib.rs"

[[bin]]
name = "ggsql"
path = "cli.rs"

[[bin]]
name = "ggsql-rest"
path = "rest.rs"
required-features = ["rest-api"]

[dependencies]
# Parsing
tree-sitter.workspace = true
tree-sitter-ggsql = { path = "../tree-sitter-ggsql" }
csscolorparser.workspace = true

# Data processing
polars.workspace = true

# Readers
duckdb = { workspace = true, optional = true }
postgres = { workspace = true, optional = true }
sqlx = { workspace = true, optional = true }
rusqlite = { workspace = true, optional = true }

# Writers
plotters = { workspace = true, optional = true }

# Serialization
serde.workspace = true
serde_json.workspace = true

# CLI and error handling
clap.workspace = true
anyhow.workspace = true
thiserror.workspace = true

# Utilities
regex.workspace = true
chrono.workspace = true

# Web server (optional)
axum = { workspace = true, optional = true }
tokio = { workspace = true, optional = true }
tower-http = { workspace = true, optional = true }
tracing = { workspace = true, optional = true }
tracing-subscriber = { workspace = true, optional = true }

# Python bindings (future)
pyo3 = { workspace = true, optional = true }

[dev-dependencies]
proptest.workspace = true

[features]
default = ["duckdb", "sqlite", "vegalite"]
duckdb = ["dep:duckdb"]
postgres = ["dep:postgres"]
sqlite = ["dep:rusqlite"]
vegalite = []
ggplot2 = []
python = ["dep:pyo3"]
rest-api = ["dep:axum", "dep:tokio", "dep:tower-http", "dep:tracing", "dep:tracing-subscriber", "duckdb", "vegalite"]
all-readers = ["duckdb", "postgres", "sqlite"]
all-writers = ["vegalite", "ggplot2", "plotters"]
