================================================================================
Simple point plot with MAPPING
================================================================================

VISUALISE
DRAW point MAPPING x AS x, y AS y

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))))))

================================================================================
Global mapping with explicit mappings
================================================================================

VISUALISE date AS x, revenue AS y
DRAW line

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Global mapping with implicit mappings
================================================================================

VISUALISE x, y
DRAW point

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Wildcard global mapping
================================================================================

VISUALISE *
DRAW point

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (wildcard_mapping))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Mixed explicit and implicit global mapping
================================================================================

VISUALISE x, y, region AS color
DRAW line

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Multi-layer plot with global mapping
================================================================================

VISUALISE date AS x, value AS y
DRAW line
DRAW point MAPPING 'red' AS color

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (literal_value
                (string)))
            aesthetic: (aesthetic_name)))))))

================================================================================
DRAW with SETTING clause
================================================================================

VISUALISE x, y
DRAW point SETTING opacity TO 0.5, size TO 3

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)
        (setting_clause
          (parameter_assignment
            param: (parameter_name
              (identifier))
            value: (parameter_value
              (number)))
          (parameter_assignment
            param: (parameter_name
              (identifier))
            value: (parameter_value
              (number))))))))

================================================================================
DRAW with FILTER clause
================================================================================

VISUALISE x, y
DRAW point FILTER x > 10

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)
        (filter_clause
          (filter_expression
            (filter_primary
              (filter_comparison
                (identifier)
                (comparison_operator)
                (number)))))))))

================================================================================
DRAW with FILTER AND condition
================================================================================

VISUALISE
DRAW point MAPPING x AS x FILTER a > 10 AND b < 20

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (filter_clause
          (filter_expression
            (filter_and_expression
              (filter_primary
                (filter_comparison
                  (identifier)
                  (comparison_operator)
                  (number)))
              (filter_expression
                (filter_primary
                  (filter_comparison
                    (identifier)
                    (comparison_operator)
                    (number)))))))))))

================================================================================
DRAW with FILTER OR condition
================================================================================

VISUALISE
DRAW point MAPPING x AS x FILTER a = 1 OR b = 2

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (filter_clause
          (filter_expression
            (filter_or_expression
              (filter_primary
                (filter_comparison
                  (identifier)
                  (comparison_operator)
                  (number)))
              (filter_expression
                (filter_primary
                  (filter_comparison
                    (identifier)
                    (comparison_operator)
                    (number)))))))))))

================================================================================
DRAW with all clauses
================================================================================

VISUALISE
DRAW point MAPPING x AS x, y AS y SETTING opacity TO 0.5 FILTER year > 2020

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (setting_clause
          (parameter_assignment
            param: (parameter_name
              (identifier))
            value: (parameter_value
              (number))))
        (filter_clause
          (filter_expression
            (filter_primary
              (filter_comparison
                (identifier)
                (comparison_operator)
                (number)))))))))

================================================================================
DRAW with string comparison in FILTER
================================================================================

VISUALISE
DRAW point MAPPING x AS x FILTER region = 'North'

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (filter_clause
          (filter_expression
            (filter_primary
              (filter_comparison
                (identifier)
                (comparison_operator)
                (string)))))))))

================================================================================
DRAW geom only (no MAPPING)
================================================================================

VISUALISE x, y
DRAW point

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Plot with scales and theme
================================================================================

VISUALISE x, y, group AS color
DRAW point
SCALE x SETTING type TO 'linear', limits TO [0, 100]
SCALE color SETTING palette TO 'viridis'
THEME minimal

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))
    (viz_clause
      (scale_clause
        (aesthetic_name)
        (scale_property
          (scale_property_name)
          (scale_property_value
            (string)))
        (scale_property
          (scale_property_name)
          (scale_property_value
            (array
              (array_element
                (number))
              (array_element
                (number)))))))
    (viz_clause
      (scale_clause
        (aesthetic_name)
        (scale_property
          (scale_property_name)
          (scale_property_value
            (string)))))
    (viz_clause
      (theme_clause
        (theme_name)))))

================================================================================
Plot with labels
================================================================================

VISUALISE x, y
DRAW point
LABEL title = 'My Plot', x = 'X Axis', y = 'Y Axis'

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)))
    (viz_clause
      (label_clause
        (label_assignment
          (label_type)
          (string))
        (label_assignment
          (label_type)
          (string))
        (label_assignment
          (label_type)
          (string))))))

================================================================================
COORD cartesian with xlim
================================================================================

VISUALISE x, y
DRAW point
COORD cartesian SETTING xlim TO [0, 100]

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)))
    (viz_clause
      (coord_clause
        (coord_type)
        (coord_properties
          (coord_property
            (coord_property_name)
            (array
              (array_element
                (number))
              (array_element
                (number)))))))))

================================================================================
COORD flip
================================================================================

VISUALISE category AS x, value AS y
DRAW bar
COORD flip

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))
    (viz_clause
      (coord_clause
        (coord_type)))))

================================================================================
VISUALISE FROM with CTE
================================================================================

WITH cte AS (SELECT * FROM x)
VISUALISE a AS x, b AS y FROM cte
DRAW point

--------------------------------------------------------------------------------

(query
  (sql_portion
    (sql_statement
      (with_statement
        (cte_definition
          (identifier)
          (select_statement
            (select_body))))))
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    source: (identifier)
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
SELECT followed by VISUALISE
================================================================================

SELECT * FROM x
VISUALISE a AS x, b AS y
DRAW bar

--------------------------------------------------------------------------------

(query
  (sql_portion
    (sql_statement
      (select_statement
        (select_body))))
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name)))
      (global_mapping_item
        (explicit_mapping
          value: (mapping_value
            (column_reference
              (identifier)))
          aesthetic: (aesthetic_name))))
    (viz_clause
      (draw_clause
        (geom_type)))))

================================================================================
Literal value in MAPPING
================================================================================

VISUALISE x, y
DRAW point MAPPING "blue" AS color

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (global_mapping
      (global_mapping_item
        (implicit_mapping
          (identifier)))
      (global_mapping_item
        (implicit_mapping
          (identifier))))
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (literal_value
                (string)))
            aesthetic: (aesthetic_name)))))))

================================================================================
VISUALISE FROM without global mapping
================================================================================

VISUALISE FROM sales
DRAW bar MAPPING category AS x, total AS y

--------------------------------------------------------------------------------

(query
  (visualise_statement
    source: (identifier)
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))))))

================================================================================
Empty VISUALISE with layer mappings
================================================================================

VISUALISE
DRAW line MAPPING date AS x, revenue AS y
DRAW point MAPPING date AS x, profit AS y

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))))
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))))))

================================================================================
PARTITION BY single column
================================================================================

VISUALISE x AS x, y AS y
DRAW line PARTITION BY category

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_type)
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (partition_clause
          (partition_columns
            (identifier)))))))

================================================================================
PARTITION BY multiple columns
================================================================================

VISUALISE x AS x, y AS y
DRAW line PARTITION BY category, region

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_type)
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (partition_clause
          (partition_columns
            (identifier)
            (identifier)))))))

================================================================================
PARTITION BY with SETTING and FILTER
================================================================================

VISUALISE x AS x, y AS y
DRAW line SETTING opacity TO 0.5 PARTITION BY category FILTER year > 2020

--------------------------------------------------------------------------------

(query
  (visualise_statement
    (viz_type)
    (viz_clause
      (draw_clause
        (geom_type)
        (mapping_clause
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name))
          (mapping_item
            value: (mapping_value
              (column_reference
                (identifier)))
            aesthetic: (aesthetic_name)))
        (setting_clause
          (parameter_assignment
            param: (parameter_name
              (identifier))
            value: (parameter_value
              (number))))
        (partition_clause
          (partition_columns
            (identifier)))
        (filter_clause
          (filter_expression
            (filter_primary
              (filter_comparison
                (identifier)
                (comparison_operator)
                (number)))))))))
